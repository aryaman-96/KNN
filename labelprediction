import pandas as pd
from sklearn.neighbors import KNeighborsClassifier

train_data = pd.read_csv('C:/Users/aaron/Downloads/datasets_with_headers/indexed-TrainingDataBinary.csv')
test_data = pd.read_csv('C:/Users/aaron/Downloads/datasets_with_headers/indexed-TestingDataBinary.csv')
X_train = train_data.iloc[0:, :128]  # select the first 128 columns as features
y_train = train_data.iloc[:, -1]  # select the last column as the target variable
X_test = test_data.iloc[:128]

# Create a KNN classifier object
knn = KNeighborsClassifier(n_neighbors=3)

# Fit the KNN classifier on the training data
knn.fit(X_train, y_train)

# Compute labels for the testing data
y_pred = knn.predict(X_test)

# Create a DataFrame to store the predicted labels
output_df = pd.DataFrame({'Predicted Labels': y_pred})

# Save the DataFrame to a CSV file
output_df.to_csv('C:/Users/aaron/Downloads/pred_lables.csv', index=False)

# Print a confirmation message
print("Predicted labels saved to", 'C:/Users/aaron/Downloads/pred_lables.csv')
